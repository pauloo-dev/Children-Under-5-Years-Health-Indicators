---
title: "Markowitz Portfolio Optimization Report"
author: "Your Name"
date: "December 2024"
output: pdf_document
fontsize: 12pt
geometry: a4paper
header-includes:
  - \usepackage[margin=3cm]{geometry}
  - \usepackage{setspace}
  - \singlespacing
---

# Introduction
Markowitz Portfolio Optimization is a fundamental technique in modern portfolio theory, introduced by Harry Markowitz in 1952. This model focuses on constructing an efficient portfolio by maximizing returns for a given level of risk or minimizing risk for a given level of return. This report implements and analyzes the Markowitz optimization process for Swedish stocks using historical data.

# Data Collection
The analysis was conducted using historical stock price data for ten Swedish companies, sourced from Yahoo Finance. The data covers the period from July 1, 2023, to June 30, 2024, and daily logarithmic returns were calculated to ensure stationarity.

Key metrics for the selected stocks are summarized in Table 1.

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(knitr)
library(quantmod)
library(PerformanceAnalytics)
library(tidyverse)

# Define stocks and date range
# Define stocks and new date range
symbols <- c("G5EN.ST", "GENO.ST", 
             "DORO.ST", "KAMBI.ST", "SYNSAM.ST", 
             "NPAPER.ST", "SKF-B.ST")
start_date <- "2023-07-01"
end_date <- "2024-08-01"

# Download data
getSymbols(symbols, src = "yahoo", from = start_date, to = end_date)

# Calculate daily returns
daily_returns <- symbols %>%
  map(~ dailyReturn(Cl(get(.x)), type = "log")) %>%
  reduce(merge)
colnames(daily_returns) <- symbols

# Calculate summary metrics
summary_stats <- data.frame(
  Mean_Return = colMeans(daily_returns, na.rm = TRUE),
  Std_Dev = apply(daily_returns, 2, sd, na.rm = TRUE)
)
summary_stats
```

**Table 1**: Summary statistics of daily returns for selected stocks.

```{r table1, echo=FALSE}
kable(summary_stats, caption = "Summary statistics of daily returns.", digits = 4)
```

# Methodology
## Mean-Variance Optimization
Markowitz optimization involves calculating the mean returns, standard deviations, and the covariance matrix for the portfolio. Using these, the efficient frontier was constructed, showing the set of optimal portfolios that minimize risk for a given level of return.

### Mathematical Formulation
The expected return of a portfolio is given by:
\[
E(R_p) = \sum_{i=1}^N w_i E(R_i)
\]
where:
- \(w_i\) is the weight of asset \(i\),
- \(E(R_i)\) is the expected return of asset \(i\).

The portfolio variance is:
\[
\sigma_p^2 = \sum_{i=1}^N \sum_{j=1}^N w_i w_j \sigma_{ij}
\]
where \(\sigma_{ij}\) represents the covariance between assets \(i\) and \(j\).

### Efficient Frontier
The efficient frontier was plotted to identify portfolios with minimum variance and the highest Sharpe ratio.

```{r optimization, echo=FALSE}
# Portfolio optimization
library(PortfolioAnalytics)
portfolio <- portfolio.spec(assets = colnames(daily_returns))
portfolio <- add.constraint(portfolio, type = "box", min = 0, max = 1)
portfolio <- add.objective(portfolio, type = "risk", name = "var")
portfolio <- add.objective(portfolio, type = "return", name = "mean")

optimized_portfolio <- optimize.portfolio(daily_returns, portfolio, optimize_method = "ROI")

# Efficient frontier
chart.EfficientFrontier(optimized_portfolio, risk.col = "StdDev", 
                        title = "Efficient Frontier")
```

**Figure 1**: Efficient Frontier for the selected portfolio.

# Results
## Minimum Variance Portfolio
The minimum variance portfolio minimizes the portfolioâ€™s risk while maintaining a reasonable level of return. The weights and risk-return characteristics are shown in Table 2.

```{r minvar, echo=FALSE}
minvar_portfolio <- minvar.portfolio(daily_returns)
minvar_weights <- extractWeights(minvar_portfolio)
minvar_weights
```

**Table 2**: Weights of the minimum variance portfolio.

```{r table2, echo=FALSE}
kable(minvar_weights, caption = "Weights for Minimum Variance Portfolio.", digits = 4)
```

## Tangency Portfolio
The tangency portfolio, maximizing the Sharpe ratio, provides the optimal trade-off between risk and return. The portfolio weights and performance are shown in Table 3.

```{r tangency, echo=FALSE}
tangency_portfolio <- maxSR.portfolio(daily_returns, risk.free = 0.01 / 252)
tangency_weights <- extractWeights(tangency_portfolio)
tangency_weights
```

**Table 3**: Weights of the tangency portfolio.

```{r table3, echo=FALSE}
kable(tangency_weights, caption = "Weights for Tangency Portfolio.", digits = 4)
```

# Discussion
The results demonstrate the utility of Markowitz optimization in portfolio construction. The minimum variance portfolio emphasizes risk minimization, while the tangency portfolio balances risk and return effectively. The efficient frontier visually underscores the trade-offs between these two strategies.

# Conclusion
Markowitz optimization provides a systematic approach to portfolio construction by quantifying risk and return trade-offs. The insights derived here form the foundation for more advanced models, which will be explored in subsequent sections of this report.
